<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZEDR22_01</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZEDR22_01</b></font>
<br>
<font size="3" face = "Arial" color="#000000"><b>Description:  프로그램 작성 교육</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*& Report ZEDR22_01</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
REPORT zedr22_01.


<font color ="#0000FF">*DATA : GV_INTEGER(5) TYPE N.</font>
<font color ="#0000FF">*GV_INTEGER = 7.</font>
<font color ="#0000FF">*WRITE : GV_INTEGER.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_NUM(5) TYPE N.</font>
<font color ="#0000FF">*GV_NUM = -5.</font>
<font color ="#0000FF">*WRITE GV_NUM.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_NUM1(5) TYPE I.</font>
<font color ="#0000FF">*GV_NUM1 = -5.</font>
<font color ="#0000FF">*WRITE GV_NUM1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_NUM2(5) TYPE P.</font>
<font color ="#0000FF">*GV_NUM2 = -5.</font>
<font color ="#0000FF">*WRITE GV_NUM2.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_NUM3(5) TYPE N.</font>
<font color ="#0000FF">*GV_NUM3 = 12345.</font>
<font color ="#0000FF">*WRITE : GV_NUM3.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_NAME(10) TYPE C.</font>
<font color ="#0000FF">*GV_NAME = '최유정'.</font>
<font color ="#0000FF">*WRITE : GV_NAME.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_N(10) TYPE N.</font>
<font color ="#0000FF">*GV_N = 10.</font>
<font color ="#0000FF">*WRITE : GV_N.</font>

<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

<font color ="#0000FF">*DATA : GS_DATA LIKE ZTEDU_22_02,</font>
<font color ="#0000FF">*      GT_DATA LIKE TABLE OF ZTEDU_22_02.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      GS_DATA-KOKRS = '1000'.</font>
<font color ="#0000FF">*      APPEND GS_DATA TO GT_DATA.</font>
<font color ="#0000FF">*      GS_DATA-KOKRS = '200'.</font>
<font color ="#0000FF">*      APPEND GS_DATA TO GT_DATA.</font>

<font color ="#0000FF">**&---------------------------------------------------------------------*</font>

<font color ="#0000FF">*DATA : GS_DATA LIKE ZTEDU22,</font>
<font color ="#0000FF">*      GT_DATA LIKE TABLE OF ZTEDU22.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GS_DATA-GJAHR = '2017'.</font>
<font color ="#0000FF">*GS_DATA-BUKRS = '1000'.</font>
<font color ="#0000FF">*GS_DATA-BELNR = '1000000001'.</font>
<font color ="#0000FF">*GS_DATA-DMBTR = '21545.00'.</font>
<font color ="#0000FF">*GS_DATA-WAERS = 'KRW'.</font>
<font color ="#0000FF">*APPEND GS_DATA TO GT_DATA.</font>
<font color ="#0000FF">*APPEND GS_DATA TO GT_DATA.</font>
<font color ="#0000FF">*APPEND GS_DATA TO GT_DATA.</font>
<font color ="#0000FF">*APPEND GS_DATA TO GT_DATA.</font>
<font color ="#0000FF">*CLEAR GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_DATA INTO GS_DATA.</font>
<font color ="#0000FF">*WRITE : GS_DATA-GJAHR, GS_DATA-BUKRS, GS_DATA-BELNR,</font>
<font color ="#0000FF">*        GS_DATA-DMBTR, GS_DATA-WAERS,/.</font>
<font color ="#0000FF">*ENDLOOP.</font>

<font color ="#0000FF">**&---------------------------------------------------------------------*</font>

DATA : gs_data LIKE sflight,
       gt_data LIKE TABLE OF sflight.

CLEAR : gt_data.

SELECT *
  INTO TABLE gt_data
  FROM sflight
  WHERE carrid = 'AA'.


LOOP AT gt_data INTO gs_data.
  WRITE : gs_data-carrid, gs_data-connid, gs_data-fldate, gs_data-price, gs_data-currency, gs_data-planetype,/.
ENDLOOP.

<font color ="#0000FF">**&-------------------------------------------------------------------------------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GS_DATA LIKE SFLIGHT,</font>
<font color ="#0000FF">*      GT_DATA LIKE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM  SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_DATA INTO GS_DATA.</font>
<font color ="#0000FF">*  WRITE : GS_DATA-CARRID, GS_DATA-CONNID, GS_DATA-FLDATE, GS_DATA-PRICE, GS_DATA-CURRENCY, GS_DATA-PLANETYPE,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">*DATA : GS_DATA LIKE SPFLI,</font>
<font color ="#0000FF">*       GT_DATA LIKE TABLE OF SPFLI.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID COUNTRYFR  CITYFROM AIRPFROM COUNTRYTO CITYTO AIRPTO</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SPFLI</font>
<font color ="#0000FF">*  WHERE CARRID = 'AA' OR CARRID = 'SQ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_DATA INTO GS_DATA.</font>
<font color ="#0000FF">*  WRITE : GS_DATA-CARRID, GS_DATA-CONNID, GS_DATA-COUNTRYFR, GS_DATA-CITYFROM, GS_DATA-AIRPFROM, GS_DATA-COUNTRYTO, GS_DATA-CITYTO, GS_DATA-AIRPTO,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GS_DATA LIKE SFLIGHT,</font>
<font color ="#0000FF">*       GT_DATA LIKE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AA' AND CONNID = '17'.</font>
<font color ="#0000FF">**  WHERE ( CARRID = 'AA' AND CONNID = 17 ) or CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  APPENDING CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_DATA INTO GS_DATA.</font>
<font color ="#0000FF">*  WRITE : GS_DATA-CARRID, GS_DATA-CONNID, GS_DATA-FLDATE, GS_DATA-PRICE, GS_DATA-CURRENCY, GS_DATA-PLANETYPE,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">*&-------------------------------------------------------------------------------------------------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GS_SPFLI LIKE SPFLI,</font>
<font color ="#0000FF">*       GT_SPFLI LIKE TABLE OF SPFLI.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SPFLI, GS_SPFLI.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID COUNTRYFR  CITYFROM AIRPFROM COUNTRYTO CITYTO AIRPTO</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI</font>
<font color ="#0000FF">*  FROM SPFLI</font>
<font color ="#0000FF">*  WHERE CARRID = 'AA' AND CONNID = '17'.</font>
<font color ="#0000FF">**  WHERE ( CARRID = 'AA' AND CONNID = 17 ) OR CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID COUNTRYFR  CITYFROM AIRPFROM COUNTRYTO CITYTO AIRPTO</font>
<font color ="#0000FF">*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SPFLI</font>
<font color ="#0000FF">*  FROM SPFLI</font>
<font color ="#0000FF">*  WHERE CARRID = 'AZ'.</font>
<font color ="#0000FF">*  READ TABLE GT_SPFLI INTO GS_SPFLI INDEX 5.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : GS_SPFLI-CONNID.</font>

<font color ="#0000FF">*DATA : GS_DATA LIKE SFLIGHT,</font>
<font color ="#0000FF">*       GT_DATA LIKE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AA' AND CONNID = '17'.</font>
<font color ="#0000FF">**  WHERE ( CARRID = 'AA' AND CONNID = 17 ) or CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  APPENDING CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AZ'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GS_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  READ TABLE GT_DATA INTO GS_DATA WITH KEY CARRID = 'AA' CONNID = '17'.</font>
<font color ="#0000FF">**  INDEX 10.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : GS_DATA-CARRID, GS_DATA-CONNID, GS_DATA-FLDATE, GS_DATA-PRICE, GS_DATA-CURRENCY, GS_DATA-PLANETYPE,/.</font>

<font color ="#0000FF">*  DATA : GS_SCARR TYPE SCARR,</font>
<font color ="#0000FF">*         GT_SCARR TYPE TABLE OF SCARR,</font>
<font color ="#0000FF">*         GS_SFLIGHT TYPE SFLIGHT,</font>
<font color ="#0000FF">*         GT_SFLIGHT TYPE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GS_SCARR, GT_SCARR, GS_SFLIGHT, GT_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT CARRID CARRNAME CURRCODE URL</font>
<font color ="#0000FF">*    INTO CORRESPONDING FIELDS OF TABLE GT_SCARR</font>
<font color ="#0000FF">*    FROM SCARR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT CARRID CONNID FLDATE PRICE CURRENCY PLANETYPE</font>
<font color ="#0000FF">*    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*    FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_SCARR INTO GS_SCARR.</font>
<font color ="#0000FF">*    CLEAR : GS_SFLIGHT.</font>
<font color ="#0000FF">*    READ TABLE GT_SFLIGHT INTO GS_SFLIGHT WITH KEY CARRID = GS_SCARR-CARRID.</font>
<font color ="#0000FF">*    WRITE : GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE, GS_SFLIGHT-CURRENCY, GS_SFLIGHT-PLANETYPE,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------------------------------------------------------------------------</font>

<font color ="#0000FF">* DATA : GS_SFLIGHT TYPE SFLIGHT,</font>
<font color ="#0000FF">*        GT_SFLIGHT TYPE TABLE OF SFLIGHT,</font>
<font color ="#0000FF">*        GS_SBOOK TYPE SBOOK,</font>
<font color ="#0000FF">*        GT_SBOOK TYPE TABLE OF SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* CLEAR : GT_SFLIGHT, GS_SFLIGHT, GT_SBOOK, GS_SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT.</font>
<font color ="#0000FF">**  WHERE CARRID = 'AA'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT CARRID CONNID FLDATE BOOKID CUSTOMID CUSTTYPE SMOKER LUGGWEIGHT WUNIT</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SBOOK</font>
<font color ="#0000FF">*  FROM SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT WHERE CARRID = 'AA'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    CLEAR : GS_SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    READ TABLE GT_SBOOK INTO GS_SBOOK WITH KEY CARRID = GS_SFLIGHT-CARRID</font>
<font color ="#0000FF">*                                               CONNID = GS_SFLIGHT-CONNID</font>
<font color ="#0000FF">*                                               FLDATE = GS_SFLIGHT-FLDATE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**    WRITE : GS_SBOOK-CARRID, GS_SBOOK-CONNID, GS_SBOOK-FLDATE, GS_SBOOK-BOOKID,</font>
<font color ="#0000FF">**            GS_SBOOK-CUSTOMID, GS_SBOOK-CUSTTYPE, GS_SBOOK-SMOKER, GS_SBOOK-LUGGWEIGHT,</font>
<font color ="#0000FF">**            GS_SBOOK-WUNIT,/.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      WRITE : GS_SBOOK-CARRID, GS_SBOOK-CONNID, GS_SBOOK-FLDATE, GS_SBOOK-BOOKID,</font>
<font color ="#0000FF">*              GS_SBOOK-CUSTOMID, GS_SBOOK-CUSTTYPE, GS_SBOOK-SMOKER, GS_SBOOK-LUGGWEIGHT,</font>
<font color ="#0000FF">*              GS_SBOOK-WUNIT,/.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* ENDLOOP.</font>

<font color ="#0000FF">* * --------------------------------------------------------------------</font>

<font color ="#0000FF">* DATA : GS_MARA TYPE MARA,</font>
<font color ="#0000FF">*        GT_MARA TYPE TABLE OF MARA,</font>
<font color ="#0000FF">*        GS_MAKT TYPE MAKT,</font>
<font color ="#0000FF">*        GT_MAKT TYPE TABLE OF MAKT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* CLEAR : GS_MARA, GT_MARA, GS_MAKT, GT_MAKT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT MATNR MTART MATKL PSTAT MEINS</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_MARA</font>
<font color ="#0000FF">*   FROM MARA</font>
<font color ="#0000FF">*   WHERE MTART = 'ROH'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT MATNR MAKTX MAKTG</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_MAKT</font>
<font color ="#0000FF">*   FROM MAKT</font>
<font color ="#0000FF">*   WHERE SPRAS = '3'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* LOOP AT GT_MARA  INTO GS_MARA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*   CLEAR : GS_MAKT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*   READ TABLE GT_MAKT INTO GS_MAKT WITH KEY MATNR = GS_MARA-MATNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*   IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*     WRITE : GS_MARA-MATNR, GS_MAKT-MAKTX,/.</font>
<font color ="#0000FF">*   ENDIF.</font>
<font color ="#0000FF">* ENDLOOP.</font>

<font color ="#0000FF">* * --------------------------------------------------------------------</font>

<font color ="#0000FF">* DATA : GS_SFLIGHT TYPE SFLIGHT,</font>
<font color ="#0000FF">*        GT_SFLIGHT TYPE TABLE OF SFLIGHT,</font>
<font color ="#0000FF">*        GS_SBOOK TYPE SBOOK,</font>
<font color ="#0000FF">*        GT_SBOOK TYPE TABLE OF SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* CLEAR : GT_SFLIGHT, GS_SFLIGHT, GT_SBOOK, GS_SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT CARRID CONNID FLDATE PRICE  CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID = 'AA'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT CARRID CONNID FLDATE BOOKID CUSTOMID CUSTTYPE SMOKER LUGGWEIGHT WUNIT</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SBOOK</font>
<font color ="#0000FF">*  FROM SBOOK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* READ TABLE GT_SFLIGHT INTO GS_SFLIGHT INDEX 1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* GS_SFLIGHT-CURRENCY = 'KRW'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* MODIFY GT_SFLIGHT FROM GS_SFLIGHT INDEX 1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WRITE : SY-TABIX,/.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* ENDLOOP.</font>

<font color ="#0000FF">* * --------------------------------------------------------------------</font>

<font color ="#0000FF">* DATA : GS_GLPCA TYPE GLPCA,</font>
<font color ="#0000FF">*        GT_GLPCA TYPE TABLE OF GLPCA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* CLEAR : GS_GLPCA, GT_GLPCA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT RLDNR RRCTY RVERS RYEAR RTCUR DOCNR DOCLN</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_GLPCA</font>
<font color ="#0000FF">*   FROM GLPCA</font>
<font color ="#0000FF">*  WHERE RLDNR = '8A'</font>
<font color ="#0000FF">*    AND RRCTY = '0'</font>
<font color ="#0000FF">*    AND RVERS = '000'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* LOOP AT GT_GLPCA INTO GS_GLPCA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    GS_GLPCA-RTCUR = 'KRW'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    MODIFY GT_GLPCA FROM GS_GLPCA INDEX SY-TABIX.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* ENDLOOP.</font>

<font color ="#0000FF">* * --------------------------------------------------------------------</font>

<font color ="#0000FF">* DATA : GS_GLPCA TYPE GLPCA,</font>
<font color ="#0000FF">*        GT_GLPCA TYPE TABLE OF GLPCA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* CLEAR : GS_GLPCA, GT_GLPCA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* SELECT RLDNR RRCTY RVERS RYEAR RTCUR DOCNR DOCLN</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_GLPCA</font>
<font color ="#0000FF">*   FROM GLPCA</font>
<font color ="#0000FF">*  WHERE RLDNR = '8A'</font>
<font color ="#0000FF">*    AND RRCTY = '0'</font>
<font color ="#0000FF">*    AND RVERS = '000'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GS_GLPCA.</font>
<font color ="#0000FF">*  READ TABLE GT_GLPCA INTO GS_GLPCA INDEX 5.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GS_GLPCA.</font>
<font color ="#0000FF">*  GS_GLPCA-RTCUR = 'KRW'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  MODIFY GT_GLPCA FROM GS_GLPCA INDEX 5 TRANSPORTING RTCUR.</font>


<font color ="#0000FF">* * --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GS_COBK TYPE COBK,</font>
<font color ="#0000FF">*       GT_COBK TYPE TABLE OF COBK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GS_COBK, GS_COBK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT KOKRS BELNR GJAHR VERSN VRGNG</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_COBK</font>
<font color ="#0000FF">*  FROM COBK</font>
<font color ="#0000FF">*  WHERE VRGNG = 'COIN'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GS_COBK.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_COBK INTO GS_COBK.</font>
<font color ="#0000FF">*  CLEAR : GS_COBK.</font>
<font color ="#0000FF">*  GS_COBK-VRGNG = 'AT01'.</font>
<font color ="#0000FF">*  MODIFY GT_COBK FROM GS_COBK TRANSPORTING VRGNG.</font>
<font color ="#0000FF">*ENDLOOP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*BREAK-POINT.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA4,</font>
<font color ="#0000FF">*          MBLNR LIKE MKPF-MBLNR,</font>
<font color ="#0000FF">*          MJAHR LIKE MKPF-MJAJR,</font>
<font color ="#0000FF">*          DMBTR LIKE MSEG-DMBTR,</font>
<font color ="#0000FF">*          MATNR LIKE MSEG-MATNR,</font>
<font color ="#0000FF">*       END OF GT_DATA4.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GS_DATA2 TYPE COBK,</font>
<font color ="#0000FF">*       GT_DATA2 TYPE TABLE OF COBK WITH HEADER LINE.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SFLIGHT LIKE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE CURRENCY PLANETYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*  GT_SFLIGHT-CURRENCY = 'KRW'.</font>
<font color ="#0000FF">*  MODIFY GT_SFLIGHT INDEX SY-TABIX TRANSPORTING CURRENCY.</font>
<font color ="#0000FF">*ENDLOOP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*  WRITE : GT_SFLIGHT-CARRID, GT_SFLIGHT-CONNID, GT_SFLIGHT-FLDATE, GT_SFLIGHT-PRICE, GT_SFLIGHT-CURRENCY, GT_SFLIGHT-PLANETYPE,/.</font>
<font color ="#0000FF">*ENDLOOP.</font>


<font color ="#0000FF">* ----------------------------------------------------------------------------------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GS_DATA TYPE SFLIGHT,</font>
<font color ="#0000FF">*       GT_DATA TYPE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*CLEAR : GS_DATA, GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GT_DATA2 TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA2, GT_DATA2[].</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_MARA TYPE TABLE OF MARA WITH HEADER LINE,</font>
<font color ="#0000FF">*       GT_MAKT TYPE TABLE OF MAKT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_MARA, GT_MARA[], GT_MAKT, GT_MAKT[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MATNR MTART MATKL MEINS</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MARA</font>
<font color ="#0000FF">*  FROM MARA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MATNR SPRAS MAKTX MAKTG</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MAKT</font>
<font color ="#0000FF">*  FROM MAKT</font>
<font color ="#0000FF">*  WHERE SPRAS = '3'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_MARA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*READ TABLE GT_MAKT WITH KEY MATNR = GT_MARA-MATNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : GT_MARA-MATNR, GT_MARA-MTART, GT_MAKT-MAKTX,/.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">* ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*ENDLOOP.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">* 출력용 ITAB</font>
<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*        MATNR LIKE MARA-MATNR,</font>
<font color ="#0000FF">*        MTART LIKE MARA-MTART,</font>
<font color ="#0000FF">*        MATKL LIKE MARA-MATKL,</font>
<font color ="#0000FF">*        MEINS LIKE MARA-MEINS,</font>
<font color ="#0000FF">*        MAKTX LIKE MAKT-MAKTX,</font>
<font color ="#0000FF">*       END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GT_MARA TYPE TABLE OF MARA WITH HEADER LINE,</font>
<font color ="#0000FF">*       GT_MAKT TYPE TABLE OF MAKT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GT_DATA[],</font>
<font color ="#0000FF">*        GT_MARA, GT_MARA[],</font>
<font color ="#0000FF">*        GT_MAKT, GT_MAKT[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MATNR MTART MATKL MEINS</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MARA</font>
<font color ="#0000FF">*  FROM MARA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MATNR SPRAS MAKTX MAKTG</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MAKT</font>
<font color ="#0000FF">*  FROM MAKT</font>
<font color ="#0000FF">*  WHERE SPRAS = '3'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_MARA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      GT_DATA-MATNR = GT_MARA-MATNR.</font>
<font color ="#0000FF">*      GT_DATA-MTART = GT_MARA-MTART.</font>
<font color ="#0000FF">*      GT_DATA-MATKL = GT_MARA-MATKL.</font>
<font color ="#0000FF">*      GT_DATA-MEINS = GT_MARA-MEINS.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    READ TABLE GT_MAKT WITH KEY MATNR = GT_MARA-MATNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      GT_DATA-MAKTX = GT_MAKT-MAKTX.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*     APPEND GT_DATA.</font>
<font color ="#0000FF">*     CLEAR : GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*        MBLNR LIKE MKPF-MBLNR,</font>
<font color ="#0000FF">*        ZEILE LIKE MSEG-ZEILE,</font>
<font color ="#0000FF">*        MJAHR LIKE MKPF-MJAHR,</font>
<font color ="#0000FF">*        VGART LIKE MKPF-VGART,</font>
<font color ="#0000FF">*        BLART LIKE MKPF-BLART,</font>
<font color ="#0000FF">*        BWART LIKE MSEG-BWART,</font>
<font color ="#0000FF">*        MATNR LIKE MSEG-MATNR,</font>
<font color ="#0000FF">*        WERKS LIKE MSEG-WERKS,</font>
<font color ="#0000FF">*        LGORT LIKE MSEG-LGORT,</font>
<font color ="#0000FF">*       END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GT_MKPF TYPE TABLE OF MKPF WITH HEADER LINE,</font>
<font color ="#0000FF">*       GT_MSEG TYPE TABLE OF MSEG WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_MKPF, GT_MKPF[], GT_MSEG, GT_MSEG[], GT_DATA, GT_DATA[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MBLNR MJAHR VGART BLART</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MKPF</font>
<font color ="#0000FF">*  FROM MKPF</font>
<font color ="#0000FF">*  WHERE MJAHR = '2016'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT MBLNR ZEILE BWART MATNR WERKS LGORT</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_MSEG</font>
<font color ="#0000FF">*  FROM MSEG</font>
<font color ="#0000FF">*  WHERE MJAHR = '2016'</font>
<font color ="#0000FF">*  AND ZEILE = '1'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_MKPF.</font>
<font color ="#0000FF">*    READ TABLE GT_MSEG WITH KEY MBLNR = GT_MKPF-MBLNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**      GT_DATA-MBLNR = GT_MKPF-MBLNR.</font>
<font color ="#0000FF">**      GT_DATA-ZEILE = GT_MSEG-ZEILE.</font>
<font color ="#0000FF">**      GT_DATA-MJAHR = GT_MKPF-MJAHR.</font>
<font color ="#0000FF">**      GT_DATA-VGART = GT_MKPF-VGART.</font>
<font color ="#0000FF">**      GT_DATA-BLART = GT_MKPF-BLART.</font>
<font color ="#0000FF">**      GT_DATA-BWART = GT_MSEG-BWART.</font>
<font color ="#0000FF">**      GT_DATA-MATNR = GT_MSEG-MATNR.</font>
<font color ="#0000FF">**      GT_DATA-WERKS = GT_MSEG-WERKS.</font>
<font color ="#0000FF">**      GT_DATA-LGORT = GT_MSEG-LGORT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**       MOVE : GT_MSEG-LGORT TO GT_DATA-LGORT,</font>
<font color ="#0000FF">**              GT_MSEG-WERKS TO GT_DATA-WERKS,</font>
<font color ="#0000FF">**              GT_MSEG-MATNR TO GT_DATA-MATNR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*       MOVE-CORRESPONDING GT_MKPF TO GT_DATA.</font>
<font color ="#0000FF">*       MOVE-CORRESPONDING GT_MSEG TO GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*       BREAK-POINT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      APPEND GT_DATA.</font>
<font color ="#0000FF">*      CLEAR : GT_DATA.</font>
<font color ="#0000FF">*    ENDIF.</font>
<font color ="#0000FF">*  ENDLOOP.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*        NAME(10),</font>
<font color ="#0000FF">*        SUM1 TYPE I,</font>
<font color ="#0000FF">*        SUM2 TYPE N,</font>
<font color ="#0000FF">*        SUM3 TYPE P,</font>
<font color ="#0000FF">*       END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GT_DATA-NAME = '홍길동'.</font>
<font color ="#0000FF">*GT_DATA-SUM1 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM2 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM3 = 1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*COLLECT GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GT_DATA-NAME = '홍길동'.</font>
<font color ="#0000FF">*GT_DATA-SUM1 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM2 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM3 = 1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*COLLECT GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GT_DATA-NAME = '홍길동'.</font>
<font color ="#0000FF">*GT_DATA-SUM1 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM2 = 1.</font>
<font color ="#0000FF">*GT_DATA-SUM3 = 1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*COLLECT GT_DATA.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*         CARRID LIKE SFLIGHT-CARRID,</font>
<font color ="#0000FF">*         CONNID LIKE SFLIGHT-CONNID,</font>
<font color ="#0000FF">*         PRICE LIKE SFLIGHT-PRICE,</font>
<font color ="#0000FF">*  END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GT_dATA, GT_DATA[], GT_SFLIGHT, GT_SFLIGHT[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT CARRID CONNID FLDATE PRICE</font>
<font color ="#0000FF">*    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*    FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*      MOVE-CORRESPONDING GT_SFLIGHT TO GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      COLLECT GT_DATA.</font>
<font color ="#0000FF">*      CLEAR : GT_DATA.</font>
<font color ="#0000FF">*    ENDLOOP.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    CLEAR : GT_DATA, GT_DATA[], GT_SFLIGHT, GT_SFLIGHT[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    SELECT CARRID CONNID FLDATE PRICE</font>
<font color ="#0000FF">*      INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*      FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*        MOVE-CORRESPONDING GT_SFLIGHT TO GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*        APPEND GT_DATA.</font>
<font color ="#0000FF">*        CLEAR GT_DATA.</font>
<font color ="#0000FF">*      ENDLOOP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    SORT GT_DATA BY CARRID CONNID.</font>
<font color ="#0000FF">*    DELETE ADJACENT DUPLICATES FROM GT_DATA COMPARING CARRID CONNID.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    DELETE GT_DATA WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*                     AND ( CONNID = '64' OR CONNID = '17' ).</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    SORT GT_DATA BY CONNID.</font>
<font color ="#0000FF">*    SORT GT_DATA BY CARRID CONNID DESCENDING.</font>

<font color ="#0000FF">* --------------------------------------------------------------------</font>


<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*  CARRID LIKE SFLIGHT-CARRID,</font>
<font color ="#0000FF">*  CONNID LIKE SFLIGHT-CONNID,</font>
<font color ="#0000FF">*  FLDATE LIKE SFLIGHT-FLDATE,</font>
<font color ="#0000FF">*  PRICE LIKE SFLIGHT-PRICE,</font>
<font color ="#0000FF">*  BOOKID LIKE SBOOK-BOOKID,</font>
<font color ="#0000FF">*  CUSTOMID LIKE SBOOK-CUSTOMID,</font>
<font color ="#0000FF">*  CUSTTYPE LIKE SBOOK-CUSTTYPE,</font>
<font color ="#0000FF">*  END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GT_DATA, GT_DATA[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT A~CARRID A~CONNID A~FLDATE A~PRICE B~BOOKID</font>
<font color ="#0000FF">*    B~CUSTOMID B~CUSTTYPE</font>
<font color ="#0000FF">*   INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*   FROM SFLIGHT AS A</font>
<font color ="#0000FF">*  INNER JOIN SBOOK AS B</font>
<font color ="#0000FF">*    ON A~CARRID = B~CARRID</font>
<font color ="#0000FF">*    AND A~CONNID = B~CONNID</font>
<font color ="#0000FF">*    AND A~FLDATE = B~FLDATE</font>
<font color ="#0000FF">*    WHERE A~CARRID = 'AA'</font>
<font color ="#0000FF">*    ORDER BY A~FLDATE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    SORT GT_DATA BY CARRID CONNID.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    READ TABLE GT_DATA WITH KEY CARRID = 'AA'</font>
<font color ="#0000FF">*                                CONNID = '64'</font>
<font color ="#0000FF">*                       BINARY SEARCH.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WRITE SY-SUBRC.</font>


<font color ="#0000FF">* --------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0,</font>
<font color ="#0000FF">*        BOOKID LIKE SBOOK-BOOKID,</font>
<font color ="#0000FF">*        CUSTOMID LIKE SBOOK-CUSTOMID,</font>
<font color ="#0000FF">*        CUSTTYPE LIKE SBOOK-CUSTTYPE.</font>
<font color ="#0000FF">*        INCLUDE STRUCTURE SFLIGHT.</font>
<font color ="#0000FF">*DATA : END OF GT_DATA.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_DATA, GT_DATA[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PRICE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_DATA</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  ORDER BY FLDATE.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  DATA : GS_SFLIGHT TYPE SFLIGHT,</font>
<font color ="#0000FF">*         GS_SFLIGHT TYPE TABLE OF SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CLEAR : GS_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**  SELECT CARRID CONNID FLDATE CURRENCY PRICE</font>
<font color ="#0000FF">**    INTO CORRESPONDING FIELDS OF GS_SFLIGHT</font>
<font color ="#0000FF">**    FROM SFLIGHT</font>
<font color ="#0000FF">**    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">**      AND CARRID = '17'</font>
<font color ="#0000FF">**      AND FLDATE = '20150429'.</font>
<font color ="#0000FF">**  ENDSELECT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  SELECT SINGLE CARRID CONNID FLDATE CURRENCY PRICE</font>
<font color ="#0000FF">*    INTO CORRESPONDING FIELDS OF GS_SFLIGHT</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*      AND CARRID = '17'</font>
<font color ="#0000FF">*      AND FLDATE = '20150429'.</font>
<font color ="#0000FF">*  ENDSELECT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">** ---------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_PRICE LIKE SFLIGHT-PRICE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GV_PRICE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT SINGLE PRICE</font>
<font color ="#0000FF">*    INTO GV_PRICE</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*      AND CARRID = '17'</font>
<font color ="#0000FF">*      AND FLDATE = '20150429'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">** ---------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_PRICE LIKE SFLIGHT-PRICE,</font>
<font color ="#0000FF">*       GV_TYPE LIKE SFLIGHT-PLANDTYPE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_SFLIGHT TYPE SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GV_PRICE, GV_TYPE, GV_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT SINGLE PRICE PLANETYPE</font>
<font color ="#0000FF">*    INTO (GV_PRICE, GV_TYPE, GS_SFLIGHT-CURRENCY)</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*      AND CARRID = '17'</font>
<font color ="#0000FF">*      AND FLDATE = '20150429'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">** ---------------------------------------------------</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_PRICE LIKE SFLIGHT-PRICE,</font>
<font color ="#0000FF">*       GV_TYPE LIKE SFLIGHT-PLANDTYPE,</font>
<font color ="#0000FF">*       GVZ-CNT TYPE I.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_SFLIGHT TYPE SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GV_PRICE, GV_TYPE, GV_SFLIGHT, GV_CNT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT SINGLE SUM (PRICE)</font>
<font color ="#0000FF">*    INTO GV_PRICE</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*      AND CARRID = '17'</font>
<font color ="#0000FF">*      AND FLDATE = '20150429'.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : GV_CARRID LIKE SFLIGHT-CARRID,</font>
<font color ="#0000FF">*       GV-CNT TYPE I.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT SINGLE CARRID COUNT(*)</font>
<font color ="#0000FF">*    INTO (GV_CARRID, GV_CNT)</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    WHERE CARRID = 'AA'</font>
<font color ="#0000FF">*     GROUP BY CARRID.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_CNT OCCURS 0,</font>
<font color ="#0000FF">*       CARRID LIKE SFLIGHT-CARRID,</font>
<font color ="#0000FF">*       CNT TYPE I,</font>
<font color ="#0000FF">*       END OF GT_CNT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_CNT, GT_CNT[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID COUNT(*) AS CNT</font>
<font color ="#0000FF">*    INTO CORRESPONDING FIELDS OF TABLE GT_CNT</font>
<font color ="#0000FF">*    FROM SFLIGHT</font>
<font color ="#0000FF">*    GROUP BY CARRID.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : BEGIN OF GT_DATA OCCURS 0.</font>
<font color ="#0000FF">*         INCLUDE STRUCTURE SBOOK.</font>
<font color ="#0000FF">*DATA : BUKRS LIKE T001-BUKRS,</font>
<font color ="#0000FF">*       WERKS LIKE T001W-WERKS,</font>
<font color ="#0000FF">*       MATNR LIKE MARA-MATNR,</font>
<font color ="#0000FF">*       DMBTR LIKE MSEG-DMBTR,</font>
<font color ="#0000FF">*       LGORT LIKE MSEG-LGORT,</font>
<font color ="#0000FF">*       GUBUN(10),</font>
<font color ="#0000FF">*       END OF GT_DATA.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_CNT TYPE I.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SFLIGHT, GT_SFLIGHT[], GV_CNT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID PLANETYPE PRICE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GV_CNT = LINES( GT_SFLIGHT ).</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DO GV_CNT TIMES.</font>
<font color ="#0000FF">*  READ TABLE GT_SFLIGHT INDEX SY-INDEX.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*    WRITE : GT_SFLIGHT-PLANETYPE,/.</font>
<font color ="#0000FF">*  ENDIF.</font>
<font color ="#0000FF">*ENDDO.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_CNT TYPE I.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SFLIGHT, GT_SFLIGHT[], GV_CNT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID PLANETYPE PRICE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*GV_CNT = LINES( GT_SFLIGHT ).</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DO GV_CNT TIMES.</font>
<font color ="#0000FF">*  WRITE : 'SY-TABIX: ' , SY-TABIX, 'SY-INDEX: ' , SY-INDEX.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  READ TABLE GT_SFLIGHT INDEX SY-INDEX.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : '읽은 후 SY-TABIX : ' , SY-TABIX,/.</font>
<font color ="#0000FF">*ENDDO.</font>

<font color ="#0000FF">* ---------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GV_CNT_AA TYPE I,</font>
<font color ="#0000FF">*       GV_CNT_AZ TYPE I,</font>
<font color ="#0000FF">*       GV_CNT_ETC TYPE I.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SFLIGHT, GT_SFLIGHT[], GV_CNT_AA, GV_CNT_AZ, GV_CNT_ETC.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PLANETYPE PRICE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**  IF GT_SFLIGHT-CARRID = 'AA'.</font>
<font color ="#0000FF">**      GV_CNT_AA = GV_CNT_AA + 1.</font>
<font color ="#0000FF">**  ELSEIF GT_SFLIGHT-CARRID = 'AZ'.</font>
<font color ="#0000FF">**      GV_CNT_AZ = GV_CNT_AZ + 1.</font>
<font color ="#0000FF">**  ELSEIF GT_SFLIGHT-CARRID = 'ETC'.</font>
<font color ="#0000FF">**      GV_CNT_ETC = GV_CNT_ETC + 1.</font>
<font color ="#0000FF">**  ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  CASE GT_SFLIGHT-CARRID.</font>
<font color ="#0000FF">*    WHEN 'AA'.</font>
<font color ="#0000FF">*      GV_CNT_AA = GV_CNT_AA + 1.</font>
<font color ="#0000FF">**      ADD 1 TO GV_CNT_AA.</font>
<font color ="#0000FF">*    WHEN 'AZ'.</font>
<font color ="#0000FF">*      GV_CNT_AZ = GV_CNT_AZ + 1.</font>
<font color ="#0000FF">*    WHEN OTHERS.</font>
<font color ="#0000FF">*      GV_CNT_ETC = GV_CNT_ETC + 1.</font>
<font color ="#0000FF">*  ENDCASE.</font>
<font color ="#0000FF">**  IF보다 CASE를 더 추천!!</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*ENDLOOP.</font>
<font color ="#0000FF">* WRITE : 'AA: ', GV_CNT_AA, 'AZ: ', GV_CNT_AZ, 'ETC: ', GV_CNT_ETC.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : GT_SCARR TYPE TABLE OF SCARR WITH HEADER LINE,</font>
<font color ="#0000FF">*       GT_SPFLI TYPE TABLE OF SPFLI WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SCARR, GT_SCARR[], GT_SPFLI, GT_SPFLI[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CARRNAME CURRCODE URL</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR</font>
<font color ="#0000FF">*  FROM SCARR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT CARRID CONNID COUNTRYFR CITYFROM AIRPFROM COUNTRYTO</font>
<font color ="#0000FF">*       CITYTO AIRPTO FLTIME DEPTIME ARRTIME DISTANCE</font>
<font color ="#0000FF">*       DISTID FLTYPE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI</font>
<font color ="#0000FF">*  FROM SPFLI.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SORT GT_SCARR BY CARRID.</font>
<font color ="#0000FF">*SORT GT_SPFLI BY CARRID.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT GT_SCARR.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : GT_SCARR-CARRID,/,SY-ULINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  READ TABLE GT_SPFLI WITH KEY CARRID = GT_SCARR-CARRID.</font>
<font color ="#0000FF">*                      BINARY SEARCH.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  LOOP AT GT_SPFLI FROM SY-TABIX.</font>
<font color ="#0000FF">*     IF GT_SCARR-CARRID NE GT_SPFLI-CARRID.</font>
<font color ="#0000FF">*       EXIT.</font>
<font color ="#0000FF">*     ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**    CASE GT_SCARR-CARRID.</font>
<font color ="#0000FF">**      WHEN GT_SPFLI-CARRID.</font>
<font color ="#0000FF">**         WRITE : GT_SPFLI-CARRID,GT_SPFLI-CONNID, GT_SPFLI-COUNTRYFR,/.</font>
<font color ="#0000FF">**    ENDCASE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  ENDLOOP.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*ENDLOOP.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*DATA : gt_mkpf TYPE TABLE OF mkpf WITH HEADER LINE,</font>
<font color ="#0000FF">*       gt_mseg TYPE TABLE OF mseg WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : gt_mkpf, gt_mkpf[], gt_mseg, gt_mseg[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT mblnr vgart blart</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE gt_mkpf</font>
<font color ="#0000FF">*  FROM mkpf</font>
<font color ="#0000FF">*  WHERE mjahr = '2016'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT mblnr zeile bwart matnr werks</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE gt_mseg</font>
<font color ="#0000FF">*  FROM mseg</font>
<font color ="#0000FF">*  WHERE mjahr = '2016'.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SORT gt_mkpf BY mblnr.</font>
<font color ="#0000FF">*SORT gt_mseg BY mblnr.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*LOOP AT gt_mkpf.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  WRITE : 'MKPF-',gt_mkpf-mblnr,/, sy-uline.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  READ TABLE gt_mseg WITH KEY mblnr = gt_mkpf-mblnr</font>
<font color ="#0000FF">*                     BINARY SEARCH.</font>
<font color ="#0000FF">*  IF sy-subrc = 0.</font>
<font color ="#0000FF">*    LOOP AT gt_mkpf FROM sy-tabix.</font>
<font color ="#0000FF">*      IF gt_mkpf-mblnr NE gt_mseg-mblnr.</font>
<font color ="#0000FF">*        EXIT.</font>
<font color ="#0000FF">*      ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*      WRITE : 'MSEG-', gt_mseg-mblnr,</font>
<font color ="#0000FF">*              'MSEG-', gt_mseg-zeile,</font>
<font color ="#0000FF">*              'MSEG-', gt_mseg-bwart,</font>
<font color ="#0000FF">*              'MSEG-', gt_mseg-matnr,/.</font>
<font color ="#0000FF">*    ENDLOOP.</font>
<font color ="#0000FF">*  ENDIF.</font>
<font color ="#0000FF">*ENDLOOP.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*TABLES : SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN BEGIN OF BLOCK B11 WITH FRAME TITLE TEXT-001.</font>
<font color ="#0000FF">*  SELECT-OPTIONS : S_CARR FOR SFLIGHT-CARRID OBLIGATORY DEFAULT 'AA',</font>
<font color ="#0000FF">*                   S_CONN FOR SFLIGHT-CONNID OBLIGATORY NO INTERVALS MEMORY ID CON,</font>
<font color ="#0000FF">*                   S_FLDA FOR SFLIGHT-FLDATE NO-EXTENSION,</font>
<font color ="#0000FF">*                   S_CURR FOR SFLIGHT-CURRENCY NO INTERVALS NO-EXTENSION.</font>
<font color ="#0000FF">*SELECTION-SCREEN END OF BLOCK B11.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*TABLES : SFLIGHT.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN BEGIN OF BLOCK B11 WITH FRAME TITLE TEXT-001.</font>
<font color ="#0000FF">*  SELECT-OPTIONS : S_CARRID FOR SFLIGHT-CARRID,</font>
<font color ="#0000FF">*                   S_CONNID FOR SFLIGHT-CONNID.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  PARAMETERS     : P_PLTYPE LIKE SFLIGHT-PLANETYPE,</font>
<font color ="#0000FF">*                   P_CURR   LIKE SFLIGHT-CURRENCY.</font>
<font color ="#0000FF">*SELECTION-SCREEN END OF BLOCK B11.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*RANGES : GR_PLTYPE FOR SFLIGHT-PLANETYPE,</font>
<font color ="#0000FF">*         GR_CURR   FOR SFLIGHT-CURRENCY.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : GT_SFLIGHT TYPE TABLE OF SFLIGHT WITH HEADER LINE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : GT_SFLIGHT, GT_SFLIGHT[], GR_PLTYPE, GR_PLTYPE[], GR_CURR, GR_CURR[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**IF P_PLTYPE IS NOT INITIAL.  //이걸 추천!!</font>
<font color ="#0000FF">*IF P_PLTYPE NE SPACE.</font>
<font color ="#0000FF">*  GR_PLTYPE-SIGN = 'I'.</font>
<font color ="#0000FF">*  GR_PLTYPE-OPTION = 'EQ'.</font>
<font color ="#0000FF">*  GR_PLTYPE-LOW = P_PLTYPE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  APPEND GR_PLTYPE.</font>
<font color ="#0000FF">*  CLEAR GR_PLTYPE.</font>
<font color ="#0000FF">*ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF P_PLTYPE NE SPACE.</font>
<font color ="#0000FF">*SELECT CARRID CONNID FLDATE PLANETYPE CURRENCY PRICE</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">*  FROM SFLIGHT</font>
<font color ="#0000FF">*  WHERE CARRID    IN S_CARRID</font>
<font color ="#0000FF">*    AND CONNID    IN S_CONNID</font>
<font color ="#0000FF">**    AND PLANETYPE = P_PLTYPE.</font>
<font color ="#0000FF">*    AND PLANETYPE IN GR_PLTYPE.</font>
<font color ="#0000FF">**ELSE</font>
<font color ="#0000FF">**  SELECT CARRID CONNID FLDATE PLANETYPE CURRENCY PRICE</font>
<font color ="#0000FF">**  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT</font>
<font color ="#0000FF">**  FROM SFLIGHT</font>
<font color ="#0000FF">**  WHERE CARRID   IN S_CARRID</font>
<font color ="#0000FF">**    AND CONNID   IN S_CONNID</font>
<font color ="#0000FF">**    AND</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  IF SY-SUBRC = 0.</font>
<font color ="#0000FF">*    LOOP AT GT_SFLIGHT.</font>
<font color ="#0000FF">*      WRITE : GT_SFLIGHT-CARRID, GT_SFLIGHT-CONNID, GT_SFLIGHT-PLANETYPE,/.</font>
<font color ="#0000FF">*    ENDLOOP.</font>
<font color ="#0000FF">*  ENDIF.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*TABLES : mara.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN BEGIN OF BLOCK b11 WITH FRAME TITLE TEXT-001.</font>
<font color ="#0000FF">*SELECT-OPTIONS : s_matnr FOR mara-matnr OBLIGATORY,</font>
<font color ="#0000FF">*                 s_mtart FOR mara-mtart.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*PARAMETERS     : p_werks LIKE marc-werks.</font>
<font color ="#0000FF">*SELECTION-SCREEN END OF  BLOCK b11.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*RANGES : gr_werks FOR marc-werks.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : BEGIN OF gt_data OCCURS 0,</font>
<font color ="#0000FF">*         matnr LIKE mara-matnr,</font>
<font color ="#0000FF">*         werks LIKE marc-werks,</font>
<font color ="#0000FF">*         mtart LIKE mara-mtart,</font>
<font color ="#0000FF">*         matkl LIKE mara-matkl,</font>
<font color ="#0000FF">*         meins LIKE mara-meins,</font>
<font color ="#0000FF">*         pstat LIKE marc-pstat,</font>
<font color ="#0000FF">*       END OF gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : gt_data, gt_data[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF p_werks IS NOT INITIAL.</font>
<font color ="#0000FF">*  gr_werks-sign = 'I'.</font>
<font color ="#0000FF">*  gr_werks-option = 'EQ'.</font>
<font color ="#0000FF">*  gr_werks-low = p_werks.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  APPEND gr_werks.</font>
<font color ="#0000FF">*  CLEAR gr_werks.</font>
<font color ="#0000FF">*ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT a~matnr b~werks a~mtart a~matkl a~meins b~pstat</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE gt_data</font>
<font color ="#0000FF">*  FROM mara AS a</font>
<font color ="#0000FF">*  INNER JOIN marc AS b</font>
<font color ="#0000FF">*     ON a~matnr = b~matnr</font>
<font color ="#0000FF">*  WHERE a~matnr    IN s_matnr</font>
<font color ="#0000FF">*    AND a~mtart    IN s_mtart</font>
<font color ="#0000FF">*    AND b~werks    IN gr_werks.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF sy-subrc = 0.</font>
<font color ="#0000FF">*  LOOP AT gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WRITE : 'MARA- ', gt_data-matnr,</font>
<font color ="#0000FF">*            'MARC- ', gt_data-werks,</font>
<font color ="#0000FF">*            'MARA- ', gt_data-mtart,</font>
<font color ="#0000FF">*            'MARA- ', gt_data-matkl,</font>
<font color ="#0000FF">*            'MARA- ', gt_data-meins,</font>
<font color ="#0000FF">*            'MARC- ', gt_data-pstat.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  ENDLOOP.</font>
<font color ="#0000FF">*ENDIF.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*TABLES : scarr, sflight.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.</font>
<font color ="#0000FF">*SELECT-OPTIONS : s_carrid FOR scarr-carrid OBLIGATORY,</font>
<font color ="#0000FF">*                 s_connid FOR sflight-connid NO INTERVALS.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*PARAMETERS     : p_bookid LIKE sbook-bookid.</font>
<font color ="#0000FF">*SELECTION-SCREEN END OF BLOCK b1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*RANGES : gr_bookid FOR sbook-bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : BEGIN OF gt_data OCCURS 0,</font>
<font color ="#0000FF">*         carrid   LIKE scarr-carrid,</font>
<font color ="#0000FF">*         connid   LIKE sflight-connid,</font>
<font color ="#0000FF">*         fldate   LIKE sflight-fldate,</font>
<font color ="#0000FF">*         bookid   LIKE sbook-bookid,</font>
<font color ="#0000FF">*         price    LIKE sflight-price,</font>
<font color ="#0000FF">*         currency LIKE sflight-currency,</font>
<font color ="#0000FF">*         customid LIKE sbook-customid,</font>
<font color ="#0000FF">*         custtype LIKE sbook-custtype,</font>
<font color ="#0000FF">*         invoice  LIKE sbook-invoice,</font>
<font color ="#0000FF">*       END OF gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : gt_data, gt_data[], gr_bookid, gr_bookid[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF p_bookid IS NOT INITIAL.</font>
<font color ="#0000FF">*  gr_bookid-sign = 'I'.</font>
<font color ="#0000FF">*  gr_bookid-option = 'EQ'.</font>
<font color ="#0000FF">*  gr_bookid-low = p_bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*  APPEND gr_bookid.</font>
<font color ="#0000FF">*  CLEAR gr_bookid.</font>
<font color ="#0000FF">*ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT a~carrid b~connid b~fldate c~bookid b~price b~currency c~customid c~custtype c~invoice</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE gt_data</font>
<font color ="#0000FF">*  FROM scarr AS a</font>
<font color ="#0000FF">*  INNER JOIN sflight AS b</font>
<font color ="#0000FF">*  ON a~carrid = b~carrid</font>
<font color ="#0000FF">*  INNER JOIN sbook AS c</font>
<font color ="#0000FF">*  ON b~carrid = c~carrid</font>
<font color ="#0000FF">*  AND b~connid = c~connid</font>
<font color ="#0000FF">*  AND b~fldate = c~fldate</font>
<font color ="#0000FF">*  WHERE a~carrid   IN s_carrid</font>
<font color ="#0000FF">*    AND b~connid   IN s_connid</font>
<font color ="#0000FF">*    AND c~bookid   IN gr_bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF sy-subrc = 0.</font>
<font color ="#0000FF">*  LOOP AT gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WRITE : gt_data-carrid, gt_data-connid, gt_data-fldate, gt_data-bookid,</font>
<font color ="#0000FF">*            gt_data-price, gt_data-currency, gt_data-customid, gt_data-custtype, gt_data-invoice,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>
<font color ="#0000FF">*ELSE.</font>
<font color ="#0000FF">*  WRITE : 'NO DATA FOUND!!'.</font>
<font color ="#0000FF">*ENDIF.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*TABLES : scarr, sflight.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE TEXT-001.</font>
<font color ="#0000FF">*SELECT-OPTIONS : s_carrid FOR scarr-carrid OBLIGATORY,</font>
<font color ="#0000FF">*                 s_connid FOR sflight-connid NO INTERVALS.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*PARAMETERS     : p_bookid AS CHECKBOX,</font>
<font color ="#0000FF">*                 p_rd1    RADIOBUTTON GROUP rb1,</font>
<font color ="#0000FF">*                 p_rd2    RADIOBUTTON GROUP rb1,</font>
<font color ="#0000FF">*                 p_rd3    RADIOBUTTON GROUP rb1,</font>
<font color ="#0000FF">*                 p_rd4    RADIOBUTTON GROUP rb1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECTION-SCREEN END OF BLOCK b1.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CASE 'X'.</font>
<font color ="#0000FF">*  WHEN p_rd1.</font>
<font color ="#0000FF">*    WRITE : 'RD1'.</font>
<font color ="#0000FF">*  WHEN p_rd2.</font>
<font color ="#0000FF">*    WRITE : 'RD2'.</font>
<font color ="#0000FF">*  WHEN p_rd3.</font>
<font color ="#0000FF">*    WRITE : 'RD3'.</font>
<font color ="#0000FF">*ENDCASE.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*RANGES : gr_bookid FOR sbook-bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*DATA : BEGIN OF gt_data OCCURS 0,</font>
<font color ="#0000FF">*         carrid   LIKE scarr-carrid,</font>
<font color ="#0000FF">*         connid   LIKE sflight-connid,</font>
<font color ="#0000FF">*         fldate   LIKE sflight-fldate,</font>
<font color ="#0000FF">*         bookid   LIKE sbook-bookid,</font>
<font color ="#0000FF">*         price    LIKE sflight-price,</font>
<font color ="#0000FF">*         currency LIKE sflight-currency,</font>
<font color ="#0000FF">*         customid LIKE sbook-customid,</font>
<font color ="#0000FF">*         custtype LIKE sbook-custtype,</font>
<font color ="#0000FF">*         invoice  LIKE sbook-invoice,</font>
<font color ="#0000FF">*       END OF gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*CLEAR : gt_data, gt_data[], gr_bookid, gr_bookid[].</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**IF p_bookid IS NOT INITIAL.</font>
<font color ="#0000FF">**  gr_bookid-sign = 'I'.</font>
<font color ="#0000FF">**  gr_bookid-option = 'EQ'.</font>
<font color ="#0000FF">**  gr_bookid-low = p_bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">**  APPEND gr_bookid.</font>
<font color ="#0000FF">**  CLEAR gr_bookid.</font>
<font color ="#0000FF">**ENDIF.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*SELECT a~carrid b~connid b~fldate c~bookid b~price b~currency c~customid c~custtype c~invoice</font>
<font color ="#0000FF">*  INTO CORRESPONDING FIELDS OF TABLE gt_data</font>
<font color ="#0000FF">*  FROM scarr AS a</font>
<font color ="#0000FF">*  INNER JOIN sflight AS b</font>
<font color ="#0000FF">*  ON a~carrid = b~carrid</font>
<font color ="#0000FF">*  INNER JOIN sbook AS c</font>
<font color ="#0000FF">*  ON b~carrid = c~carrid</font>
<font color ="#0000FF">*  AND b~connid = c~connid</font>
<font color ="#0000FF">*  AND b~fldate = c~fldate</font>
<font color ="#0000FF">*  WHERE a~carrid   IN s_carrid</font>
<font color ="#0000FF">*    AND b~connid   IN s_connid</font>
<font color ="#0000FF">*    AND c~bookid   IN gr_bookid.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*IF sy-subrc = 0.</font>
<font color ="#0000FF">*  LOOP AT gt_data.</font>
<font color ="#0000FF">*</font>
<font color ="#0000FF">*    WRITE : gt_data-carrid, gt_data-connid, gt_data-fldate, gt_data-bookid,</font>
<font color ="#0000FF">*            gt_data-price, gt_data-currency, gt_data-customid, gt_data-custtype, gt_data-invoice,/.</font>
<font color ="#0000FF">*  ENDLOOP.</font>
<font color ="#0000FF">*ELSE.</font>
<font color ="#0000FF">*  WRITE : 'NO DATA FOUND!!'.</font>
<font color ="#0000FF">*ENDIF.</font>

<font color ="#0000FF">* ------------------------------------------------------------------------</font>

<font color ="#0000FF">*Text elements</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">* 001 검색조건</font>


<font color ="#0000FF">*Selection texts</font>
<font color ="#0000FF">*----------------------------------------------------------</font>
<font color ="#0000FF">* P_BOOKID D       .</font>
<font color ="#0000FF">* S_CARRID D       .</font>
<font color ="#0000FF">* S_CONNID D       .</font>
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 750
</font>
</body>
</html>
